
@base: #158;
//@base: #3a133e;

@teams: desaturate(darken(@base, 5%), 7%);
@msgSent: lighten(spin(@base, 30), 37%);
@msgReceived: #ddd;


background: #fff;
color: #333;

content {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	display: flex;

	i[class^="icon-"] {
		display: inline-block;
		vertical-align: middle;
		width: 17px;
		height: 17px;
		background-size: cover;
		background-repeat: no-repeat;
		background-position: 50% 50%;
		//filter: invert() brightness(85%);

		&.icon-return       { background-image: url(~/icons/icon-return.png); }
		&.icon-search       { background-image: url(~/icons/icon-search.png); }
		&.icon-clock        { background-image: url(~/icons/icon-clock.png); }
		&.icon-date         { background-image: url(~/icons/icon-date.png); }
		&.icon-info         { background-image: url(~/icons/icon-info.png); }
		&.icon-phone        { background-image: url(~/icons/icon-phone.png); }
		&.icon-arrow-right  { background-image: url(~/icons/icon-arrow-right.png); }
		&.icon-arrow-left   { background-image: url(~/icons/icon-arrow-left.png); }
		&.icon-users        { background-image: url(~/icons/icon-users.png); }
		&.icon-user         { background-image: url(~/icons/icon-user.png); }
		&.icon-add-user     { background-image: url(~/icons/icon-add-user.png); }
		&.icon-remove-user  { background-image: url(~/icons/icon-remove-user.png); }

		&.icon-chevron-left { background-image: url(~/icons/icon-chevron-left.png); }
		&.icon-offline      { background-image: url(~/icons/icon-offline.png); }
		&.icon-online       { background-image: url(~/icons/icon-online.png); }
		&.icon-threads      { background-image: url(~/icons/icon-threads.png); }
		&.icon-thread       { background-image: url(~/icons/icon-thread.png); }
		&.icon-plus         { background-image: url(~/icons/icon-plus.png); }
	}

	.anim-typing {
		position: relative;
		display: inline-block;
		width: 27px;
		height: 11px;

		&.tiny {
			top: 2px;
			transform: scale(.65);
		}

		b {
			background: lighten(@base, 23%);
			display: inline-block;
			position: absolute;
			top: 8px;
			width: 4px;
			height: 4px;
			border-radius: 50%;
			animation: wave 1600ms infinite ease-in-out;

			&:nth-child(1) {
				left: 3px;
			}

			&:nth-child(2) {
				left: 11px;
				animation-delay: 140ms;
			}

			&:nth-child(3) {
				left: 19px;
				animation-delay: 280ms;
			}
		}
	}

	.teams {
		background: @teams;
		color: #fff;
		width: 63px;
		padding-top: 13px;
		text-align: center;

		.team {
			background: lighten(@teams, 5%);
			background-repeat: no-repeat;
			background-size: contain;
			background-position: 50% 50%;
			color: lighten(@teams, 17%);
			position: relative;
			display: inline-block;
			width: 37px;
			height: 37px;
			border-radius: 7px;
			margin-bottom: 13px;

			&:before {
				content: attr(data-name);
				position: absolute;
				top: 50%;
				left: 0;
				width: 100%;
				transform: translateY(-50%);
				font-size: 17px;
				font-weight: 700;
			}

			&:hover:not(.active) {
				cursor: pointer;
				color: lighten(@teams, 37%);
			}

			&.active {
				color: lighten(@teams, 37%);

				&:after {
					content: "";
					position: absolute;
					top: -6px;
					left: -6px;
					right: -6px;
					bottom: -6px;
					border: 3px solid lighten(@teams, 19%);
					border-radius: 13px;
				}
			}
		}
	}

	.threads {
		background: @base;
		color: #eef;
		display: flex;
		flex-direction: column;
		width: 220px;
		font-size: 14px;

		.threads-list {
			flex: 1;
			padding: 7px 0;

			ul {
				margin-bottom: 13px;
				transition: margin 200ms ease-in-out;

				li {
					padding: 4px 7px 5px 23px;
					margin-bottom: 1px;
					user-select: none;
				}
			}
		}

		h2 {
			padding: 5px 7px 7px 13px;
			font-weight: 500;
			user-select: none;
		}

		i[class^="icon-"] {
			width: 12px;
			height: 12px;
			margin-right: 5px;
			pointer-events: none;

			&.icon-chevron-left { width: 10px; height: 10px; margin-top: -2px; }
			&.icon-plus         { width: 9px; height: 9px; margin: -2px 6px 0 2px; }
		}

		.name {
			display: inline-block;
			vertical-align: middle;
			pointer-events: none;
		}

		.add-channel,
		.add-member {
			opacity: .5;
			padding: 4px 7px 5px 23px;
			cursor: pointer;

			&:hover {
				opacity: 1;
			}
		}

		.channels-list,
		.members-list {
			position: relative;
			overflow: hidden;
			max-height: 500px;
			transition: max-height 200ms ease-in-out;
		}

		.channels.collapsed,
		.members.collapsed {
			.channels-list,
			.members-list {
				max-height: 0;

				ul {
					margin-top: -100%;
				}
			}
		}

		.channels {
			.channel {
				cursor: pointer;

				&.active {
					background: lighten(@base, 11%);
				}
			}
		}

		.members {
			.member {
				opacity: .5;
				cursor: pointer;

				&.active {
					background: lighten(@base, 11%);
				}

				&.online {
					opacity: 1;

					.icon-offline { background-image: url(~/icons/icon-online.png); }
				}
			}
		}
	}

	.transcript {
		background: #f7f7f7;
		flex: 1;
		display: flex;
		flex-direction: column;

		.output-body {
			flex: 1;
			padding: 7px 3px;
			overflow-x: hidden;
			overflow-y: auto;

			> .message{
				position: relative;
				border-radius: 13px;
				font-size: 13px;
				line-height: 1.35;
				padding: 5px 11px;
				max-width: 73%;
				margin: 5px 5px;
				clear: both;
				transition: margin 150ms ease-in-out;

				&:after {
					content: "";
				    position: absolute;
				    bottom: 0px;
				    width: 16px;
				    height: 9px;
				}

				&:first-child {
					margin-top: 0;
				}

				&.focused {
					margin-bottom: 19px;

					.date {
						visibility: visible;
						opacity: 1;
					}
				}

				&.sent {
					background: @msgSent;
					color: #fff;
					float: right;
					margin-right: 43px;
					//filter: drop-shadow(0 1px 0 #ddd);

					&:after {
					    right: -9px;
					    background: radial-gradient(circle at top right, transparent 49%, @msgSent 56%);
					    border-radius: 0 0 0 11px;
					}

					.avatar {
						background: desaturate(spin(@msgSent, -15), 17%);
						left: auto;
						right: -37px;
					}

					.date {
						left: auto;
						right: 0;
						text-align: right;
					}
				}

				&.received {
					background: @msgReceived;
					color: #222;
					float: left;
					margin-left: 43px;

					&:after {
					    left: -9px;
					    background: radial-gradient(circle at top left, transparent 49%, @msgReceived 56%);
					    border-radius: 0 0 11px 0;
					}

					&:before {
						content: attr(data-from);
						position: absolute;
						top: -16px;
						left: 5px;
						font-size: 11px;
						white-space: nowrap;
						color: #aaa;
					}

					& + .received {
						&:before {
							display: none;
						}
					}
				}

				&.typing {
					background: @msgReceived;
					color: #222;
					float: left;
					margin-left: 43px;

					&:before,
					&:after {
						content: "";
						background: inherit;
					    position: absolute;
					    bottom: -2px;
					    left: 0;
						width: 11px;
						height: 11px;
						border-radius: 50%;
					}

					&:after {
						width: 4px;
						height: 4px;
						bottom: -3px;
						left: -3px;
					}
				}

				.avatar {
					background-color: darken(@msgReceived, 13%);
					position: absolute;
					left: -37px;
					bottom: 0;
					display: inline-block;
					width: 27px;
					border-radius: 50%;
					//box-shadow: 0 0 0 1px #ddd;

					&:before {
						content: attr(data-name);
						position: absolute;
						top: 50%;
						left: 0;
						width: 100%;
						z-index: 1;
						transform: translateY(-50%);
						font-size: 12px;
						font-weight: 400;
						text-align: center;
						color: #fff;
						text-shadow: 0 1px 1px rgba(0,0,0,.25);
					}

					&:after {
						content: "";
						position: relative;
						z-index: 2;
						display: block;
						padding-top: 100%;
						border-radius: inherit;
						background-image: inherit;
						background-position: 50% 50%;
						background-size: 100% auto;
						background-repeat: no-repeat;
					}
				}

				.date {
					visibility: hidden;
					opacity: 0;
					position: absolute;
					bottom: -18px;
					left: 0;
					white-space: nowrap;
					text-align: left;
					font-size: 11px;
					color: #aaa;
					transition: opacity 150ms ease-in-out;
				}
			}
		}

		.input {
			padding: 9px;

			> div {
				position: relative;
				background: #fff;
				border-radius: 5px;
				box-shadow: 0 0 0 1px #ddd;
				font-size: 13px;
				line-height: 1.35;
				padding: 7px 9px;

				&:empty:not(:focus):before {
					content: attr(placeholder);
					color: #666;
				}

				&:after {
					content: "";
					background: url(~/icons/icon-return.png) 50% 50% no-repeat;
					position: absolute;
					bottom: 7px;
					right: 9px;
					width: 16px;
					height: 16px;
					opacity: .35;
				}
			}
		}
	}

	.info {
		background: #fff;
		display: flex;
		flex-direction: column;
		width: 200px;
		transition: width 200ms ease-in-out;

		&.hidden {
			width: 0;
		}

		.info-body {
			width: 200px;

			.profile {
				position: relative;
				padding: 13px 0;
				margin-bottom: 7px;
				text-align: center;
				border-bottom: 1px solid #eee;

				.avatar {
					background-color: #eee;
					background-position: 50% 50%;
					background-size: 100% auto;
					background-repeat: no-repeat;
					display: inline-block;
					margin-bottom: 5px;
					width: 67%;
					border-radius: 50%;

					&:before {
						content: "";
						display: block;
						padding-top: 100%;
					}
				}

				h2 {
					font-size: 16px;
				}
			}

			.field {
				display: flex;
				padding: 5px 13px;

				span {
					&:nth-child(1) {
						width: 40%;
						color: #888;
					}
					&:nth-child(2) {
						width: 60%;
						color: #222;
						text-align: right;
					}
				}
			}
		}
	}
}

@keyframes wave {
	0%, 40% { top: 8px; }
	20%     { top: 1px; }
}
