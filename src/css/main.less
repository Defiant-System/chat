
@base: #158;
//@base: #3a133e;

@teams: desaturate(darken(@base, 5%), 7%);
@msgSent: lighten(spin(@base, 30), 37%);
@msgReceived: #ddd;


background: #fff;
color: #333;

content {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	display: flex;
	font-size: 14px;

	i[class^="icon-"] {
		display: inline-block;
		vertical-align: middle;
		width: 17px;
		height: 17px;
		background-size: cover;
		background-repeat: no-repeat;
		background-position: 50% 50%;
		//filter: invert() brightness(85%);

		&.icon-info         { background-image: url(~/icons/icon-info.png); }
		&.icon-return       { background-image: url(~/icons/icon-return.png); }
		&.icon-search       { background-image: url(~/icons/icon-search.png); }
		&.icon-clock        { background-image: url(~/icons/icon-clock.png); }
		&.icon-date         { background-image: url(~/icons/icon-date.png); }
		&.icon-info         { background-image: url(~/icons/icon-info.png); }
		&.icon-phone        { background-image: url(~/icons/icon-phone.png); }
		&.icon-arrow-right  { background-image: url(~/icons/icon-arrow-right.png); }
		&.icon-arrow-left   { background-image: url(~/icons/icon-arrow-left.png); }
		&.icon-users        { background-image: url(~/icons/icon-users.png); }
		&.icon-user         { background-image: url(~/icons/icon-user.png); }
		&.icon-add-user     { background-image: url(~/icons/icon-add-user.png); }
		&.icon-remove-user  { background-image: url(~/icons/icon-remove-user.png); }

		&.icon-chevron-left { background-image: url(~/icons/icon-chevron-left.png); }
		&.icon-offline      { background-image: url(~/icons/icon-offline.png); }
		&.icon-online       { background-image: url(~/icons/icon-online.png); }
		&.icon-threads      { background-image: url(~/icons/icon-threads.png); }
		&.icon-thread       { background-image: url(~/icons/icon-thread.png); }
		&.icon-plus         { background-image: url(~/icons/icon-plus.png); }
	}

	.anim-typing {
		position: relative;
		display: inline-block;
		width: 27px;
		height: 11px;

		&.tiny {
			top: 2px;
			transform: scale(.65);
		}

		b {
			background: lighten(@base, 23%);
			display: inline-block;
			position: absolute;
			top: 8px;
			width: 4px;
			height: 4px;
			border-radius: 50%;
			animation: wave 1600ms infinite ease-in-out;

			&:nth-child(1) {
				left: 3px;
			}

			&:nth-child(2) {
				left: 11px;
				animation-delay: 140ms;
			}

			&:nth-child(3) {
				left: 19px;
				animation-delay: 280ms;
			}
		}
	}

	.teams {
		background: @teams;
		color: #fff;
		position: relative;
		width: 63px;
		padding-top: 13px;
		text-align: center;

		.team {
			background: lighten(@teams, 5%);
			background-repeat: no-repeat;
			background-size: contain;
			background-position: 50% 50%;
			color: lighten(@teams, 17%);
			position: relative;
			display: inline-block;
			width: 37px;
			height: 37px;
			border-radius: 7px;
			margin-bottom: 13px;

			&:before {
				content: attr(data-name);
				position: absolute;
				top: 50%;
				left: 0;
				width: 100%;
				transform: translateY(-50%);
				font-size: 17px;
				font-weight: 700;
			}

			&:hover:not(.active) {
				cursor: pointer;
				color: lighten(@teams, 37%);
			}

			&.active {
				color: lighten(@teams, 37%);

				&:after {
					content: "";
					position: absolute;
					top: -6px;
					left: -6px;
					right: -6px;
					bottom: -6px;
					border: 3px solid lighten(@teams, 19%);
					border-radius: 13px;
				}

				.notification {
					display: none;
				}
			}

			.notification {
				position: absolute;
				top: -3px;
				right: -3px;
				width: 9px;
				height: 9px;
				z-index: 2;
				background: #f44;
				border-radius: 50%;
			}
		}
	}

	.threads {
		background: @base;
		color: #eef;
		display: flex;
		flex-direction: column;
		width: 220px;
		font-size: 14px;

		.threads-list {
			flex: 1;
			overflow-y: auto;
			padding: 7px 0;

			ul {
				margin-bottom: 13px;
				transition: margin 200ms ease-in-out;

				li {
					display: flex;
					padding: 4px 7px 5px 23px;
					margin-bottom: 1px;
					user-select: none;
				}
			}
		}

		h2 {
			padding: 5px 7px 7px 13px;
			font-weight: 500;
			user-select: none;

			.icon-chevron-left {
				transform: rotate(90deg);
				transition: transform 120ms ease-in-out;
			}
		}

		i[class^="icon-"] {
			width: 12px;
			height: 12px;
			margin: 1px 5px 0 0;
			pointer-events: none;

			&.icon-chevron-left { width: 10px; height: 10px; }
			&.icon-plus         { width: 9px; height: 9px; margin: 2px 7px 0 2px; }
		}

		.name {
			flex: 1;
			vertical-align: middle;
			pointer-events: none;
			overflow: hidden;
			text-overflow: ellipsis;
			white-space: nowrap;
			margin-right: 3px;

			span {
				opacity: .5;
				position: relative;
				top: -1px;
				left: 5px;
				font-size: 12px;
			}
		}

		.notification {
			padding: 2px 7px 1px 6px;
			background: #f55;
			color: #fee;
			border-radius: 10px;
			font-size: 12px;
			margin-top: -1px;
			// font-weight: 700;
			// text-shadow: 0 1px 0 #b22;
		}

		.add-channel,
		.add-member,
		.add-friend {
			opacity: .5;
			padding: 4px 7px 5px 23px;
			cursor: pointer;

			&:hover {
				opacity: 1;
			}
		}

		.channels-list,
		.members-list,
		.friends-list {
			position: relative;
			overflow: hidden;
			max-height: 500px;
			transition: max-height 200ms ease-in-out;
		}

		.channels.collapsed,
		.members.collapsed {
			h2 .icon-chevron-left {
				transform: rotate(0deg);
			}
			.channels-list,
			.members-list {
				max-height: 0;

				ul {
					margin-top: -100%;
				}
			}
		}

		.channels {
			.channel {
				cursor: pointer;

				&.active {
					background: lighten(@base, 11%);
				}
			}
		}

		.members .member,
		.friends .friend {
			cursor: pointer;

			&.active {
				background: lighten(@base, 11%);
			}

			&.online {
				.icon-offline,
				.name {
					opacity: 1;
				}

				.icon-offline { background-image: url(~/icons/icon-online.png); }
			}

			.icon-offline,
			.name {
				opacity: .5;
			}
		}
	}

	.transcript {
		background: #f7f7f7;
		flex: 1;
		display: flex;
		flex-direction: column;

		i[class^="icon-"] {
			width: 12px;
			height: 12px;
			margin: -2px 0 0 3px;
		}

		.output {
			flex: 1;
			overflow-x: hidden;
			overflow-y: auto;

			.wrapper {
				display: table;
				width: 100%;
				height: calc(100% - 18px);
			}
		}

		.output-body {
			display: table-cell;
			vertical-align: bottom;
			padding: 17px 3px 0;
			line-height: 1.35;

			.initial-message {
				background: #fff;
				color: #777;
				padding: 7px 11px;
				margin: 5px 5px;
				border-radius: 5px;
				box-shadow: 0 0 0 1px #ddd;

				i[class^="icon-"] {
					filter: invert() opacity(.55);

					&.icon-info { filter: opacity(.8); }
				}
			}

			.message {
				position: relative;
				margin: 11px 5px;
				text-align: right;
				//clear: both;
				transition: margin 150ms ease-in-out;
				
				.msg-wrapper {
					position: relative;
					border-radius: 13px;
					max-width: 73%;
					padding: 5px 11px;
					display: inline-block;
					text-align: left;
					overflow-wrap: anywhere;

					&:after {
						content: "";
					    position: absolute;
					    bottom: 0px;
					    width: 16px;
					    height: 9px;
					}

					code {
						display: block;
						width: 440px;
						overflow: auto;
						background: #f2f2f2;
						border-radius: 3px;
						box-shadow: 0 0 0 1px #bbb;
						margin: 4px 0;
						padding: 3px 5px;
						white-space: pre;
						text-align: left;
						font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;
						font-size: 13px;
					}

					img {
						max-width: 100%;
					}

					.giphy-wrapper {
						&:after {
							content: "Powered By GIPHY";
							font-size: 12px;
							opacity: .6;
						}

						img {
							margin: 5px 0 -3px;
						}
					}
				}

				&:first-child {
					margin-top: 0;
				}

				&:last-child {
					margin-bottom: 0;
				}

				&.focused {
					margin-bottom: 19px;

					.date {
						visibility: visible;
						opacity: 1;
					}
				}

				&.sent {
					text-align: right;

					.msg-wrapper {
						background: @msgSent;
						color: #fff;
						margin-right: 43px;

						&:after {
						    right: -9px;
						    background: radial-gradient(circle at top right, transparent 49%, @msgSent 56%);
						    border-radius: 0 0 0 11px;
						}
					}

					.avatar {
						background: desaturate(spin(@msgSent, -15), 17%);
						left: auto;
						right: -37px;
					}

					.date {
						left: auto;
						right: 0;
						text-align: right;
					}
				}

				&.received {
					text-align: left;

					.msg-wrapper {
						background: @msgReceived;
						color: #222;
						text-align: left;
						margin-left: 43px;

						&:after {
						    left: -9px;
						    background: radial-gradient(circle at top left, transparent 49%, @msgReceived 56%);
						    border-radius: 0 0 11px 0;
						}

						&:before {
							content: attr(data-from);
							position: absolute;
							top: -16px;
							left: 5px;
							font-size: 11px;
							white-space: nowrap;
							color: #aaa;
						}

						& + .received {
							&:before {
								display: none;
							}
						}
					}
				}

				&.typing {
					max-height: 40px;
					transition: max-height 120ms ease-in-out;

					.msg-wrapper {
						background: @msgReceived;
						color: #222;
						text-align: left;
						margin-left: 43px;

						&:before,
						&:after {
							content: "";
							background: inherit;
						    position: absolute;
						    top: auto;
						    bottom: -2px;
						    left: 0;
							width: 11px;
							height: 11px;
							border-radius: 50%;
						}

						&:after {
							width: 4px;
							height: 4px;
							bottom: -3px;
							left: -3px;
						}

						b {
							background: darken(@msgReceived, 29%);
						}
					}

					&.removing {
						max-height: 0px;
						overflow: hidden;
					}
				}

				.avatar {
					background-color: darken(@msgReceived, 13%);
					position: absolute;
					left: -37px;
					bottom: 0;
					display: inline-block;
					width: 28px;
					border-radius: 50%;
					//box-shadow: 0 0 0 1px #ddd;

					&:before {
						content: attr(data-name);
						position: absolute;
						top: 50%;
						left: 0;
						width: 100%;
						z-index: 1;
						transform: translateY(-50%);
						font-size: 13px;
						font-weight: 400;
						text-align: center;
						color: #fff;
						text-shadow: 0 1px 1px rgba(0,0,0,.25);
					}

					&:after {
						content: "";
						position: relative;
						z-index: 2;
						display: block;
						padding-top: 100%;
						border-radius: inherit;
						background-image: inherit;
						background-position: 50% 50%;
						background-size: 100% auto;
						background-repeat: no-repeat;
					}
				}

				.date {
					visibility: hidden;
					opacity: 0;
					position: absolute;
					bottom: -18px;
					left: 0;
					white-space: nowrap;
					text-align: left;
					font-size: 11px;
					color: #aaa;
					transition: opacity 150ms ease-in-out;
				}
			}
		}

		.input {
			padding: 9px;

			> div {
				position: relative;
				background: #fff;
				border-radius: 5px;
				box-shadow: 0 0 0 1px #bbb;
				line-height: 1.35;
				padding: 7px 9px;

				&:empty:before {
					content: attr(placeholder);
					color: #666;
				}

				&:not(:empty):after {
					background-color: @msgSent;
					filter: invert() hue-rotate(45deg) saturate(50%);
					opacity: 1;
				}

				&:after {
					content: "";
					background: url(~/icons/icon-return.png) 3px 50% no-repeat;
					background-size: 17px 17px;
					position: absolute;
					bottom: 4px;
					right: 5px;
					width: 24px;
					height: 24px;
					border-radius: 3px;
					opacity: .35;
				}
			}
		}
	}

	.info {
		background: #fff;
		display: flex;
		flex-direction: column;
		width: 220px;
		font-size: 13px;
		transition: width 200ms ease-in-out;

		&.hidden {
			width: 0;
		}

		.info-body {
			width: 220px;

			.profile {
				position: relative;
				padding: 13px 0;
				margin-bottom: 7px;
				text-align: center;
				border-bottom: 1px solid #eee;

				.avatar {
					background-color: #eee;
					background-position: 50% 50%;
					background-size: 100% auto;
					background-repeat: no-repeat;
					display: inline-block;
					margin-bottom: 5px;
					width: 67%;
					border-radius: 50%;

					&:before {
						content: "";
						display: block;
						padding-top: 100%;
					}
				}

				h2 {
					font-size: 16px;
				}
			}

			.field {
				display: flex;
				padding: 5px 13px;

				span {
					&:nth-child(1) {
						width: 40%;
						color: #888;
					}
					&:nth-child(2) {
						width: 60%;
						color: #222;
						text-align: right;
					}
				}
			}
		}
	}
}

@keyframes wave {
	0%, 40% { top: 8px; }
	20%     { top: 1px; }
}
